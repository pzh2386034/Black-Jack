---
title: ARM64内存管理十八：内存回收之LRU链表
date: 2019-09-30
categories:
- linux-memory
tags:
- mempool
---

## 前沿

### 往篇回顾

>在上一篇中，主要分析了内存池的实现、运行机制；内存池实际是一个最后的内存资源储存池，本身还是依赖于现有的伙伴系统或者slub系统

* 主要涉及`mempool_create`, `mempool_destroy`, `mempool_alloc`, `mempool_free`这几个函数；

* 重点在内存申请的时候，首先从自定义的mempool->alloc尝试分配，失败后再从内存池中获取；

* 如果内存池也分配失败，则会自行加入mempool->wait队列中，并将本进程自动睡眠等待有空闲内存或者时间截止被唤醒；


### 内存回收简述

* 当linux系统内存压力就大时，就会对系统的每个压力大的zone(最新的linux动向逐渐转向按node回收)进程内存回收，内存回收主要是针对匿名页和文件页进行的

* 内存回收的核心思想，就是如果一些数据能够保存到磁盘，在内存不足时就把这些数据写到磁盘中，这样这些数据占用的内存页就可以作为空闲内存页给予系统使用了

* LRU链表的作用即将这些数据收集起来，作为情况释放内存的来源


### 本篇主要内容

>对于整个内存回收来说，lru链表是关键中的关键，实际上整个内存回收，做的事情就是处理LRU(Least Recently Used)链表的收缩，所以这篇文章就先说说系统的lru链表
